pipeline {
  agent { label 'master' }
  stages {
    stage('test') { 
       
      environment{
        crumbToken = sh(script: ''' curl GET http://35.163.210.168:8080/crumbIssuer/api/json --user admin:admin |awk -F , '{print $2}' |awk -F : '{print $2}'|sed 's/"//g'  ''', returnStdout: true)          
           } 
      steps {
     //    sh 'echo $crumbToken'
     //   sh ''' curl -X POST -u admin:admin  'http://35.163.210.168:8080/job/testingcurl/buildWithParameters?name="sreedhar"&country="India"&mobilenumber="0000000000"'  -H 'Jenkins-Crumb: $crumbToken' '''
     //     sh ''' curl -X POST -u admin:admin  'http://35.163.210.168:8080/job/testingcurl' -H 'Jenkins-Crumb: $crumbToken'  '''
          sh ''' curl -u admin:119ef5484ee3f09dcfa6edbc5539376ed6 http://35.163.210.168:8080/job/test/buildWithParameters?token=remote-token -F name="sreedhar" country="India"  '''
      }
    }
    
    }
}
  
